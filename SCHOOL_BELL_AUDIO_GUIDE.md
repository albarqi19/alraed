# ุฏููู ุฅุฏุงุฑุฉ ุงูุฃุตูุงุช ููุธุงู ุงูุฌุฑุณ ุงููุฏุฑุณู

ููุฏู ูุฐุง ุงูุฏููู ูุชุณููู ุชุฌููุฒ ุงูุฃุตูุงุช ุงูุฎุงุตุฉ ุจูุธุงู ุงูุฌุฑุณ ุงููุฏุฑุณู ุฏุงุฎู ุงููุงุฌูุฉ ุงูุฌุฏูุฏุฉุ ูุน ุถูุงู ุนูู ุงูุฌุฑุณ ุญุชู ูู ูุถุน ุนุฏู ุงูุงุชุตุงู ูุนูุฏ ุชุซุจูุช ุงูุชุทุจูู ูุชุทุจูู ููุจ ุชูุฏูู (PWA).

## ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

1. **ุชูุณููุงุช ุงูุตูุช ุงููุณููุญุฉ:** ููุตู ุจุงุณุชุฎุฏุงู โ`.mp3`โ ู โ`.ogg`โ ูุถูุงู ุงูุชูุงูู ูุน ูุนุธู ุงููุชุตูุญุงุช.
2. **ุงูุทูู ุงููุซุงูู:** ุจูู 5 โ 20 ุซุงููุฉุ ุญุชู ูุง ูุชุฃุฎุฑ ุชุดุบูู ุงูุญุฏุซ ุงูุชุงูู.
3. **ุญุฌู ุงูููู:** ุฃูู ูู โ1 MBโ ููู ููู. ุงุณุชุฎุฏู ุฃุฏูุงุช ุงูุถุบุท ูุซู [ffmpeg](https://ffmpeg.org/) ุฃู [Audio Compressor](https://audio.online-convert.com/).
4. **ุงูุชุณููุฉ:** ุงุณุชุฎุฏู ูุธุงู ุชุณููุฉ ููุญุฏูุง (ุฑุงุฌุน ูุณู "๐ ูุธุงู ุงูุชุณููุฉ ุงูููุชุฑุญ" ุฃุฏูุงู) ูุถูุงู ุณูููุฉ ุงููุฑุฒ ูุงูุชุญุฏูุซ.

## ูุฑุงุญู ุงูุฏูุฌ

### 1. ุฑูุน ุงููููุงุช ุฅูู ุงูุฎุงุฏู (ุฎูุงุฑ ูุณุชูุจูู)
- ุฃุถู ููุทุฉ ููุงูุฉ (API) ูุงุณุชูุจุงู ุงููููุงุช: `POST /admin/school-bell/audio`.
- ุฎุฒูู ุจูุงูุงุช ุงูููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ุงูุญููู ุงูุชุงููุฉ: ุงููุนุฑูุ ุงูุงุณูุ ุงููุณุงุฑุ ุงูุญุฌูุ ูุฏุฉ ุงูุชุดุบููุ ุญุงูุฉ ุงููุฒุงููุฉ.
- ุฃุนุฏ ูุงุฆูุฉ ุงูุฃุตูุงุช ูู ุฎูุงู `GET /admin/school-bell/audio` ูุชุบุฐูุฉ ููุชุจุฉ ุงูุฃุตูุงุช ูู ุงููุงุฌูุฉ.

### 2. ุงูุชุฎุฒูู ุงููุญูู ุนูุฏ ุชุซุจูุช ุงูู PWA
- ุนูุฏ ุญุฏุซ `appinstalled` ุฃู ุฃูู ุชุดุบูู ุจุนุฏ ุงูุชุซุจูุชุ ุงุณุชุฏุนู ููุทุฉ ููุงูุฉ ุงูุฃุตูุงุช ุซู ุฎุฒูู ุงููููุงุช ุนุจุฑ `CacheStorage` ุฏุงุฎู Service Worker.
- ุงุณุชุฎุฏู ูุณุงุฑูุง ูุฎุตุตูุง ูููุงุดุ ูุซู: `school-bell-audio-v1`.
- ูู ุจุชุณุฌูู ุญุงูุฉ ุงูุตูุช (ุฌุงูุฒ / ุจุงูุชุธุงุฑ / ููููุฏ) ูู `localStorage` ุฃู `IndexedDB` ุจููุณ ุตูุบุฉ ุงูุญููู ุงููุนุฑูุถุฉ ูู ุงููุงุฌูุฉ (`BellAudioAsset`).
  - ูุฌุจ ุฃู ูููู ุงูููู ูุชุงุญูุง ุนุจุฑ ุงููุณุงุฑ ุงูููุงุณู: `/school-bell-audio/<asset-id>.mp3` ููุชูุงูู ูุน ูุดุบู ุงููุงุฌูุฉ.

### 3. ูุฒุงููุฉ ุงูุฃุตูุงุช
- ูุนูู ูููุฉ `sync` ุฏุงุฎู Service Worker ุจุงุณู `sync-school-bell-audio`.
- ุนูุฏ ุชููุฑ ุงุชุตุงูุ ูู ุจุชูุฒูู ุงููููุงุช ุบูุฑ ุงูููุฌูุฏุฉ ูุฅุนุงุฏุฉ ุชุญุฏูุซ ุงูุญุงูุฉ ูู ุงููุงุฌูุฉ ุจูุงุณุทุฉ ุญุฏุซ `postMessage`.
- ูู ุญุงู ูุดู ุงูุชุญูููุ ุณุฌู ุงูุญุงูุฉ `missing` ูุน ุขุฎุฑ ูุญุงููุฉ ูุฒุงููุฉ.

### 4. ุชุดุบูู ุงูุตูุช
- ุงููุงุฌูุฉ ุงูุญุงููุฉ ุชุณุชุฎุฏู ุฎุทุงู `useSchoolBellEngine` ุงูุฐู ูููู ุจุงูุขุชู:
  1. ุชุญููู ุนูุตุฑ `<audio>` ููู ููู ูุชุฎุฒููู ูู ุงูุฐุงูุฑุฉ ูุน ุชูุนูู `preload="auto"`.
  2. ูุญุงููุฉ ุงุณุชุฆูุงู `AudioContext` ุนูุฏ ุงูุญุงุฌุฉ ูุชุฌุงูุฒ ูููุฏ ุงููุชุตูุญ.
  3. ุชุดุบูู ูุบูุฉ ุงุญุชูุงุทูุฉ ูุฏุชูุง โ5 ุซูุงูู ุนูุฏ ูุดู ุชุดุบูู ุงูููู ุงูุฃุตููุ ูุน ุชุณุฌูู ููุงุญุธุฉ ูู ุงูุณุฌู.
- ุนูุฏ ุชุดุบูู ุญุฏุซ ุงูุฌุฑุณ:
  1. ูุชู ุชุญููู ุงูููู ูู `CacheStorage` ุฃูููุงุ ูุฅู ูู ููู ูุชููุฑูุง ูุณูุณุชุฎุฏู ุงููุณุงุฑ `/school-bell-audio/<asset-id>.mp3`.
  2. ูุชู ุชุดุบูู ุงูุตูุช ููุฑุงูุจุฉ ุงููุชูุฌุฉ (`played` / `fallback-played` / `failed`) ูุชุญุฏูุซ ุงูุณุฌู ุงููุญุธู.
  3. ูู ุญุงู ุงููุดูุ ููุนุฑุถ ุขุฎุฑ ุฎุทุฃ ููุงุญุธ ูู ููุญุฉ ุงูุชุญูู ูุฅุนุงุฏุฉ ุงููุญุงููุฉ ุฃู ูุญุต ุงูุงุชุตุงู.

### 5. ุฅุฏุงุฑุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู
- ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุฆูุฉ ุงูุฃุตูุงุช ูุญูููุง ูู `IndexedDB` ูุถูุงู ุงูุงุณุชุฑุฌุงุน ุงูุณุฑูุน.
- ูุนูู ุชูุจูููุง ุนูุฏ ุงุฎุชูุงู ุงูุชูุงููุน (hash) ุจูู ุงููุณุฎุฉ ุงููุญููุฉ ูุงูุฎุงุฏู ูุฅุนุงุฏุฉ ุงูุชุญููู.

## ุฑุจุท ุงููุงุฌูุฉ ุงูุญุงููุฉ

- ููู `admin-school-bell-page.tsx` ูุณุชุฎุฏู ูููู `BellAudioAsset` ูุฅุธูุงุฑ ุญุงูุฉ ูู ุตูุช ูู ููุชุจุฉ ุงูุฃุตูุงุช.
- ูุชู ุญูุธ ูุนูููุงุช ุญุฒู ุงููุจุฑุงุช (`ToneProfile`) ุถูู ุงูุญุงูุฉ ุจุญูุซ ูุนุฑู ูู ุฌุฏูู ุฃู ููุชุจุฉ ุฃุตูุงุช ูุณุชุฎุฏููุง.
- ุชู ุชูุตูู ุงููุดุบู ุจุฎูุงุฑุฒููุฉ ุฌุฏููุฉ ุชุนูู ูู ุงูููุฏูุฉ ูุงูุฎูููุฉ ุนุจุฑ ุนุงูู ููุจ (`school-bell-timer.ts`).
- ูุชู ุชุณุฌูู ูู ุชุดุบูู ูู `runtimeLog` ูุน ูุตุฏุฑ ุงูุชุดุบูู (ูุฏููุ ุชููุงุฆูุ ุฎูููุฉ) ูุชุณููู ุงูุชุชุจุน.
- ุนูุฏ ุชูููุฑ ูุงุฌูุฉ ุจุฑูุฌูุฉ ุญููููุฉ:
  - ุงุณุชุจุฏู ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ ุจุทูุจ `useQuery` ูุฌูุจ ุงูุฃุตูุงุช.
  - ุญุฏูุซ ุฏูุงู `handleUpdateAudioStatus` ูุชุณุชุฏุนู ููุงุท ุงูููุงูุฉ ุงููุนููุฉ.
  - ูุฑูุฑ ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ ุฅูู ูููููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุฅุธูุงุฑ ุญุงูุฉ ุงููุฒุงููุฉ.

## ๐ ูุธุงู ุงูุชุณููุฉ ุงูููุชุฑุญ ููุฃุตูุงุช

ุงุนุชูุฏ ุงูุตูุบุฉ ุงูุชุงููุฉ ูุชุณููุฉ ุงููููุงุช: `<season>-<purpose>-<intensity>-v<version>.mp3`

- **season:** `winter`, `summer`, `ramadan`, `exams`, ุฃู `generic` ููุฃุตูุงุช ุงูุนุงูุฉ.
- **purpose:** `start`, `end`, `break`, `assembly`, `alert`, `prayer`, ุฅูุฎ.
- **intensity:** `soft`, `standard`, `energetic`, `calm`.
- **version:** ุฑูู ุงูุฅุตุฏุงุฑ ูุชูููุฒ ุงูุชุนุฏููุงุช (ุงุจุฏุฃ ุจู `1`).

ุฃูุซูุฉ:

- `winter-start-standard-v1.mp3`
- `ramadan-prayer-soft-v2.mp3`
- `generic-break-energetic-v1.mp3`

ุนูุฏ ุงูุฑูุน ุฅูู ุงููุณุชูุฏุน ุงูุตูุชูุ ุงุณุชุฎุฏู ููุณ ุงููุนุฑู (ุจุฏูู ุงูุงูุชุฏุงุฏ) ูู `id` ูู `BellAudioAsset` ูุถูุงู ุงูุชูุงูู ูุน ุงููุณุงุฑ `/school-bell-audio/<id>.mp3`.

## ๐๏ธ ุชูุธูู ุงูููุชุจุฉ ุงูุตูุชูุฉ ุนูู GitHub

ุงุญุฑุต ุนูู ุชุฑุชูุจ ุงููููุงุช ุงูุตูุชูุฉ ุฏุงุฎู ุงููุณุชูุฏุน ุจุญุณุจ ุญุฒู ุงููุจุฑุงุชุ ูุซููุง:

```
school-bell-audio/
  calm-voice-v1/
    calm-start-v1.mp3
    calm-end-v1.mp3
    calm-break-v1.mp3
    calm-prayer-v1.mp3
    calm-generic-v1.mp3
  grand-voice-v1/
    grand-start-v1.mp3
    grand-end-v1.mp3
    grand-break-v1.mp3
    grand-prayer-v1.mp3
    grand-generic-v1.mp3
  bright-voice-v1/
    bright-start-v1.mp3
    bright-end-v1.mp3
    bright-break-v1.mp3
    bright-prayer-v1.mp3
    bright-generic-v1.mp3
```

- ุงุณู ุงููุฌูุฏ = ูุนุฑู ุงููุจุฑุฉ (`toneProfileId`).
- ุงูุฃุณูุงุก ุฏุงุฎู ุงููุฌูุฏ ูุฌุจ ุฃู ุชุชูุงูู ูุน ุงูููู ุงููุนุฑูุฉ ูู ุฎุฑูุทุฉ ุงููุจุฑุฉ (`mapping`) ููุฃุญุฏุงุซ (`lesson_start`, `lesson_end`, `break`, `prayer`, `custom`ุ ู`generic`).
- ุนูุฏ ุฅุถุงูุฉ ุญุฒูุฉ ุฌุฏูุฏุฉุ ุฃูุดุฆ ูุฌูุฏูุง ุฌุฏูุฏูุง ุจููุณ ุงูููุท ุซู ุฃุถู ุชุนุฑูููุง ุฏุงุฎู ูุตูููุฉ `ToneProfile` ูู ุงููุงุฌูุฉ.
- ูููู ุงุณุชุถุงูุฉ ุงููููุงุช ุนูู GitHub Pages ุฃู ุฃู CDNุ ููู ุงุญุชูุธ ุจููุณ ุงูุจููุฉ ุญุชู ุชุชุนุฑู ุงููุงุฌูุฉ ุนูู ุงููุณุงุฑุงุช ุชููุงุฆููุง.

> ุนูุฏ ุชูุฒูู ุงูููุชุจุฉุ ุฎุฒูู ูู ููู ุนูู ุงููุณุงุฑ ุงููุญูู `/school-bell-audio/<filename>` ุจุญูุซ ุชุจูู ุนูููุฉ ุฅุณูุงุฏ ุงูุฃุตูุงุช ุชููุงุฆูุฉ ููู ุงูุฃุญุฏุงุซ ุฏูู ุชุฏุฎู ูุฏูู.

## ูุตุงุฆุญ ุฅุถุงููุฉ

- ููุฑ ูุบูุฉ ุงุญุชูุงุทูุฉ ูุฏูุฌุฉ ุฏุงุฎู ุงูุชุทุจูู ุชุนูู ุญุชู ูู ุญุงู ูุดู ุชุญููู ุจุงูู ุงููุบูุงุช.
- ุฑุงูุจ ุงุณุชููุงู ุงูุจุทุงุฑูุฉ ูู ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ ุฃู ุงูุญูุงุณูุจ ุงูุตุบูุฑุฉุ ูุฃู ุชุดุบูู ุงูุฃุตูุงุช ุจูุซุงูุฉ ูุฏ ูุคุซุฑ ุนูู ุงูุฃุฏุงุก.
- ุงุฎุชุจุฑ ุงูุฃุตูุงุช ุนูู ุณูุงุนุงุช ุงููุธุงู ุงูุญููููุฉ ูุถุจุท ูุณุชููุงุช ุงูุตูุช ูุจู ูุดุฑูุง ุฑุณูููุง.
- ุนูุฏ ุชูุนูู ุฎุงุตูุฉ "ุงูุชุดุบูู ูู ุงูุฎูููุฉ" ุชุฃูุฏ ูู ููุญ ุตูุงุญูุงุช ุฅุดุนุงุฑุงุช/ุชุดุบูู ุจุงูุฎูููุฉ ููุฌูุงุฒ ุจุญูุซ ูุณุชุทูุน ุนุงูู ุงูููุจ ุฅุทูุงู ุงููุบูุงุช ูู ููุชูุง.
- ุนูุฏ ุชุญุฏูุซ ููู ุฏุงุฎู ุญุฒูุฉ ูุจุฑุฉุ ุฒุฏ ุฑูู ุงูุฅุตุฏุงุฑ ูู ุงูุงุณู (ูุซุงู: `calm-start-v2.mp3`) ูุญุฏูุซ ุชุนุฑูู ุงูุญุฒูุฉ ูู ุงููุงุฌูุฉ ูุถูุงู ุชุดุบูู ุงูููู ุงูุตุญูุญ.

> **ููุงุญุธุฉ:** ุนูุฏูุง ูุชู ุฑุจุท ุงููุธุงู ุจุงููุงุฌูุฉ ุงูุฎูููุฉุ ุชุฃูุฏ ูู ุชุญููู ููู `SCHOOL_BELL_AUDIO_GUIDE.md` ูุชูุซูู ุฃู ุชุบููุฑุงุช ูู ุชุฏูู ุงูุนูู ุฃู ุชูุณููุงุช ุงูุจูุงูุงุช.
